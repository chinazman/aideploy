# v2.0 æ¶æ„é‡æ„å®Œæˆ

## âœ… å®Œæˆçš„å·¥ä½œ

### 1. æœåŠ¡ç«¯æ”¹è¿›

#### æ–°å¢é™æ€æ–‡ä»¶æ‰˜ç®¡ ([server/static.go](server/static.go))
- âœ… Go æœåŠ¡ç›´æ¥æ‰˜ç®¡é™æ€æ–‡ä»¶,æ— éœ€ Nginx
- âœ… æ”¯æŒå­åŸŸåæ¨¡å¼ (site.example.com)
- âœ… æ”¯æŒè·¯å¾„æ¨¡å¼ (example.com/site)
- âœ… è‡ªåŠ¨ MIME ç±»å‹æ£€æµ‹
- âœ… æ™ºèƒ½ç¼“å­˜ç­–ç•¥ (JS/CSS ç¼“å­˜1å¹´, HTMLä¸ç¼“å­˜)
- âœ… ETag æ”¯æŒ,å‡å°‘å¸¦å®½æ¶ˆè€—
- âœ… SPA è·¯ç”±æ”¯æŒ

#### æ–°å¢éƒ¨ç½²æ¥å£
- âœ… `/api/sites/deploy-full` - å…¨é‡éƒ¨ç½²
- âœ… `/api/sites/deploy-incremental` - å¢é‡éƒ¨ç½²
- âœ… tar.gz æ ¼å¼å‹ç¼©ä¼ è¾“

### 2. å®¢æˆ·ç«¯æ”¹è¿›

#### æ–°å¢éƒ¨ç½²å™¨ ([client/deployer.go](client/deployer.go))
- âœ… æ–‡ä»¶å“ˆå¸Œè¿½è¸ª (MD5)
- âœ… å˜æ›´æ£€æµ‹ç®—æ³•
- âœ… å¢é‡æ‰“åŒ…
- âœ… å…¨é‡æ‰“åŒ…
- âœ… è·Ÿè¸ªä¿¡æ¯ç®¡ç† (`~/.aideploy/tracking/`)

#### æ–°å¢å‘½ä»¤
```bash
deploy-cli deploy <name> <dir>       # æ™ºèƒ½éƒ¨ç½²
deploy-cli deploy-full <name> <dir>  # å…¨é‡éƒ¨ç½²
deploy-cli deploy-inc <name> <dir>   # å¢é‡éƒ¨ç½²
```

### 3. é¡¹ç›®ç»“æ„è°ƒæ•´

- âœ… `main.go` ç§»åˆ°æ ¹ç›®å½•
- âœ… ä¿®å¤ package å£°æ˜å†²çª
- âœ… æ›´æ–°æ‰€æœ‰æ„å»ºè„šæœ¬
- âœ… æ¸…ç†æœªä½¿ç”¨çš„ import

### 4. æ–‡æ¡£æ›´æ–°

- âœ… [README.md](README.md) å®Œå…¨é‡å†™
- âœ… æ–°å¢æ¶æ„è¯´æ˜
- âœ… æ–°å¢ä½¿ç”¨ç¤ºä¾‹
- âœ… æ–°å¢ API æ–‡æ¡£

## ğŸ“ ä½¿ç”¨æ–¹æ³•

### å¿«é€Ÿå¼€å§‹

```bash
# 1. å¯åŠ¨æœåŠ¡å™¨ (é¦–æ¬¡è¿è¡Œä¼šåˆ›å»ºé…ç½®)
./quick-start.bat    # Windows
./quick-start.sh     # Linux/macOS

# 2. ç¼–è¾‘ config.json
{
  "base_domain": "example.com",
  "web_root": "./websites",
  "mode": "subdomain",
  "port": 8080,
  "enable_versioning": true
}

# 3. å†æ¬¡å¯åŠ¨
./quick-start.bat

# 4. éƒ¨ç½²ç½‘ç«™
deploy-cli create my-site
deploy-cli deploy my-site ./test-site

# 5. è®¿é—®
http://my-site.example.com:8080
```

### éƒ¨ç½²æ¨¡å¼å¯¹æ¯”

| æ¨¡å¼ | å‘½ä»¤ | è¯´æ˜ | é€Ÿåº¦ |
|------|------|------|------|
| æ™ºèƒ½éƒ¨ç½² | `deploy` | è‡ªåŠ¨é€‰æ‹©å¢é‡æˆ–å…¨é‡ | ğŸš€ æœ€å¿« |
| å¢é‡éƒ¨ç½² | `deploy-inc` | åªä¼ å˜æ›´æ–‡ä»¶ | âš¡ å¿« |
| å…¨é‡éƒ¨ç½² | `deploy-full` | ä¼ è¾“æ‰€æœ‰æ–‡ä»¶ | ğŸ“¦ æ…¢ |

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### å¢é‡éƒ¨ç½²åŸç†

1. å®¢æˆ·ç«¯æ‰«ææœ¬åœ°ç›®å½•,è®¡ç®—æ¯ä¸ªæ–‡ä»¶çš„ MD5 å“ˆå¸Œ
2. ä¸ä¸Šæ¬¡éƒ¨ç½²çš„è·Ÿè¸ªè®°å½•å¯¹æ¯”
3. åªæ‰“åŒ…å˜æ›´çš„æ–‡ä»¶
4. æœåŠ¡ç«¯è§£å‹è¦†ç›–
5. æ›´æ–° Git æäº¤

### æ–‡ä»¶è¿½è¸ª

```json
// ~/.aideploy/tracking/my-site.json
{
  "site_name": "my-site",
  "last_sync": "2025-01-16T20:30:00Z",
  "files": [
    {
      "path": "index.html",
      "hash": "5d41402abc4b2a76b9719d911017c592",
      "size": 1024,
      "mod_time": "2025-01-16T20:00:00Z",
      "last_deployed": "2025-01-16T20:30:00Z"
    }
  ]
}
```

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

- [ ] å®ç° HTTP multipart ä¸Šä¼  (ç›®å‰åªæœ‰æ‰“åŒ…é€»è¾‘)
- [ ] æ·»åŠ åˆ é™¤æ–‡ä»¶çš„å¢é‡éƒ¨ç½²æ”¯æŒ
- [ ] Web ç®¡ç†ç•Œé¢
- [ ] Docker éƒ¨ç½²æ”¯æŒ
- [ ] HTTPS æ”¯æŒ
- [ ] ç”¨æˆ·è®¤è¯

## ğŸ› å·²çŸ¥é—®é¢˜

1. **HTTP ä¸Šä¼ æœªå®Œæˆ**: `deployer.go` ä¸­çš„ `uploadPackage` æ–¹æ³•è¿˜æ˜¯ç©ºå®ç°
2. **éœ€è¦å®ç° multipart/form-data ä¸Šä¼ é€»è¾‘**

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

å‡è®¾ç½‘ç«™æœ‰ 100 ä¸ªæ–‡ä»¶,æ€»å¤§å° 10MB:

| åœºæ™¯ | v1.0 | v2.0 å¢é‡ | æå‡ |
|------|------|-----------|------|
| é¦–æ¬¡éƒ¨ç½² | 10MB | 10MB | - |
| ä¿®æ”¹ 1 ä¸ªæ–‡ä»¶ | 10MB | ~100KB | **100x** |
| ä¿®æ”¹ 10 ä¸ªæ–‡ä»¶ | 10MB | ~1MB | **10x** |

## âœ¨ æ ¸å¿ƒä¼˜åŠ¿

1. **æ— éœ€ Nginx** - Go æœåŠ¡ç›´æ¥æ‰˜ç®¡,å¼€ç®±å³ç”¨
2. **æ™ºèƒ½å¢é‡** - åªä¼ å˜æ›´æ–‡ä»¶,èŠ‚çœå¸¦å®½å’Œæ—¶é—´
3. **ç›®å½•éƒ¨ç½²** - æ”¯æŒæ•´ä¸ªç½‘ç«™ç›®å½•,ä¸å†æ˜¯å•æ–‡ä»¶
4. **è‡ªåŠ¨è¿½è¸ª** - å®¢æˆ·ç«¯è‡ªåŠ¨ç®¡ç†æ–‡ä»¶çŠ¶æ€
5. **ä¿ç•™ç‰ˆæœ¬** - ä»ç„¶æ”¯æŒ Git ç‰ˆæœ¬ç®¡ç†
